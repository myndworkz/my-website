function drawStickmanPart() {
    const stickmanParts = [
        () => { ctx.moveTo(50, 250); ctx.lineTo(50, 50); ctx.stroke(); }, // Vertical Pole
        () => { ctx.moveTo(50, 50); ctx.lineTo(100, 50); ctx.stroke(); }, // Horizontal Pole
        () => { ctx.moveTo(100, 50); ctx.lineTo(100, 75); ctx.stroke(); }, // Rope
        () => { ctx.beginPath(); ctx.arc(100, 100, 25, 0, Math.PI * 2); ctx.stroke(); }, // Head
        () => { ctx.moveTo(100, 125); ctx.lineTo(100, 200); ctx.stroke(); }, // Body
        () => { ctx.moveTo(100, 150); ctx.lineTo(70, 180); ctx.stroke(); }, // Left Arm
        () => { ctx.moveTo(100, 150); ctx.lineTo(130, 180); ctx.stroke(); }, // Right Arm
        () => { ctx.moveTo(100, 200); ctx.lineTo(80, 250); ctx.stroke(); }, // Left Leg
        () => { ctx.moveTo(100, 200); ctx.lineTo(120, 250); ctx.stroke(); }  // Right Leg
    ];
    const incorrectGuessIndex = 9 - attemptsLeft;
    if (stickmanParts[incorrectGuessIndex]) {
        stickmanParts[incorrectGuessIndex]();
    }

    if (attemptsLeft <= 0) {
        disableAllButtons();
    }
}

function disableAllButtons() {
    const buttons = document.querySelectorAll('.letter');
    buttons.forEach(button => button.disabled = true);
}

function checkGameOver() {
    if (!guessedWord.includes("_")) {
        speechBubble.textContent = "You won!";
        positionSpeechBubble();
        disableAllButtons();
        console.log("Game won!");
    } else if (attemptsLeft <= 0) {
        speechBubble.textContent = `Game over! The word was ${selectedWord}.`;
        positionSpeechBubble();
        disableAllButtons();
        console.log("Game lost!");
    }
}

function positionSpeechBubble() {
    const assistantRect = assistant.getBoundingClientRect();
    const canvasRect = canvas.getBoundingClientRect();
    const bubbleHeight = speechBubble.offsetHeight;

    // Position speech bubble below the assistant but avoid overlapping the canvas
    const newTop = Math.min(assistantRect.bottom + 10, canvasRect.top - bubbleHeight - 10);
    speechBubble.style.top = `${newTop}px`;
    speechBubble.style.display = "block";
}

function triggerHatAnimation(animationType) {
    const topHat = assistant.querySelector('.top-hat');
    if (!topHat) return;
    topHat.classList.add(animationType);
    setTimeout(() => {
        topHat.classList.remove(animationType);
    }, 1000);
}
